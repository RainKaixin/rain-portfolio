// Artwork data - concept art works from the local folder (ordered by number suffix)
const artworkData = [
    {
        src: 'works_jpg/concept_art_works/Assembly Under the Nine_01.jpg',
        alt: 'Assembly Under the Nine'
    },
    {
        src: 'works_jpg/concept_art_works/Port Arrival_02.jpg',
        alt: 'Port Arrival'
    },
    {
        src: 'works_jpg/concept_art_works/Grand Domestic of the East_03.jpg',
        alt: 'Grand Domestic of the East'
    },
    {
        src: 'works_jpg/concept_art_works/The City of Peace_04.jpg',
        alt: 'The City of Peace'
    },
    {
        src: 'works_jpg/concept_art_works/The Grand Civilization_05.jpg',
        alt: 'The Grand Civilization'
    },
    {
        src: 'works_jpg/concept_art_works/Southern Citadel_06.jpg',
        alt: 'Southern Citadel'
    },
    {
        src: 'works_jpg/concept_art_works/City in the sky_07.jpg',
        alt: 'City in the sky'
    },
    {
        src: 'works_jpg/concept_art_works/The Snow Ground_08.jpg',
        alt: 'The Snow Ground'
    },
    {
        src: 'works_jpg/concept_art_works/Departure_09.png',
        alt: 'Departure'
    },
    {
        src: 'works_jpg/concept_art_works/Unicron II_10.jpg',
        alt: 'Unicron II'
    },
    {
        src: 'works_jpg/concept_art_works/The path to Atlantis_11.jpg',
        alt: 'The path to Atlantis'
    },
    {
        src: 'works_jpg/concept_art_works/Pontu City_12.jpg',
        alt: 'Pontu City'
    },
    {
        src: 'works_jpg/concept_art_works/Lost city in desert_13.jpg',
        alt: 'Lost city in desert'
    },
    {
        src: 'works_jpg/concept_art_works/Ancient Dux_15.jpg',
        alt: 'Ancient Dux'
    },
    {
        src: 'works_jpg/concept_art_works/The Battleship_16.jpg',
        alt: 'The Battleship'
    }
];

// Vertical artwork data - vertical concept art works from the local folder
const verticalArtworkData = [
    {
        src: 'works_jpg/concept_art_works/vertical_works/The Grand Domestic.jpg',
        alt: 'The Grand Domestic'
    },
    {
        src: 'works_jpg/concept_art_works/vertical_works/New City Data Below.jpg',
        alt: 'New City Data Below'
    },
    {
        src: 'works_jpg/concept_art_works/vertical_works/Starts on the Horizon.jpg',
        alt: 'Starts on the Horizon'
    },
    {
        src: 'works_jpg/concept_art_works/vertical_works/Above the Desert II.jpg',
        alt: 'Above the Desert II'
    },
    {
        src: 'works_jpg/concept_art_works/vertical_works/Above the Desert.jpg',
        alt: 'Above the Desert'
    },
    {
        src: 'works_jpg/concept_art_works/vertical_works/The Light and Darkness of Ozymandias.jpg',
        alt: 'The Light and Darkness of Ozymandias'
    }
];

// Dual reality artwork data - dual reality concept art works from the local folder
const dualRealityArtworkData = [
    {
        src: 'works_jpg/concept_art_works/dual reality/Beyond Reality.jpg',
        alt: 'Beyond Reality'
    },
    {
        src: 'works_jpg/concept_art_works/dual reality/rain-wang-asset (2).jpg',
        alt: 'Dual Reality Asset 2'
    },
    {
        src: 'works_jpg/concept_art_works/dual reality/rain-wang-asset (3).jpg',
        alt: 'Dual Reality Asset 3'
    },
    {
        src: 'works_jpg/concept_art_works/dual reality/rain-wang-asset (4).jpg',
        alt: 'Dual Reality Asset 4'
    },
    {
        src: 'works_jpg/concept_art_works/dual reality/rain-wang-asset (5).jpg',
        alt: 'Dual Reality Asset 5'
    },
    {
        src: 'works_jpg/concept_art_works/dual reality/rain-wang-asset (6).jpg',
        alt: 'Dual Reality Asset 6'
    }
];

// Illustration artwork data - main illustration works from the local folder
const illustrationArtworkData = [
    {
        src: 'works_jpg/illustration_works/The Tolerance For The Majority_01.jpg',
        alt: 'The Tolerance For The Majority'
    },
    {
        src: 'works_jpg/illustration_works/Pillars_02.jpg',
        alt: 'Pillars'
    },
    {
        src: 'works_jpg/illustration_works/Attack at Dawn_03.jpg',
        alt: 'Attack at Dawn!'
    },
    {
        src: 'works_jpg/illustration_works/Bodley Engineerin.jpg',
        alt: 'Bodley Engineerin'
    },
    {
        src: 'works_jpg/illustration_works/Fall of Constantinople.jpg',
        alt: 'Fall of Constantinople'
    },
    {
        src: 'works_jpg/illustration_works/No Conditions.jpg',
        alt: 'No Conditions'
    },
    {
        src: 'works_jpg/illustration_works/Solace of Butterflies.jpg',
        alt: 'Solace of Butterflies'
    },
    {
        src: 'works_jpg/illustration_works/The last moment.jpg',
        alt: 'The last moment'
    },
    {
        src: 'works_jpg/illustration_works/Where Shadows Seek After People.jpg',
        alt: 'Where Shadows Seek After People'
    }
];

// Illustration practice works data from the local folder
const illustrationPracticeData = [
    {
        src: 'works_jpg/illustration_works/illustration practice works/And the Desert Echoed.jpg',
        alt: 'And the Desert Echoed'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/The Thorn Bird.jpg',
        alt: 'The Thorn Bird'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/VAR.jpg',
        alt: 'VAR'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/Alpha.jpg',
        alt: 'Alpha'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/Radiant Daylight.jpg',
        alt: 'Radiant Daylight'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/BETA.jpg',
        alt: 'BETA'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/Illustration Practice 03.jpg',
        alt: 'Illustration Practice 03'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/Illustration Practice 02.jpg',
        alt: 'Illustration Practice 02'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/Book of Hours.jpg',
        alt: 'Book of Hours'
    },
    {
        src: 'works_jpg/illustration_works/illustration practice works/Illustration Practice 01.jpg',
        alt: 'Illustration Practice 01'
    }
];

// Map design works data from the local folder
const mapDesignData = [
    {
        src: 'works_jpg/map_works/map 1219.jpg',
        alt: 'Map 1219'
    },
    {
        src: 'works_jpg/map_works/babelyon ad02.png',
        alt: 'Babelyon AD02'
    },
    {
        src: 'works_jpg/map_works/map_05.png',
        alt: 'Map 05'
    },
    {
        src: 'works_jpg/map_works/map_06.png',
        alt: 'Map 06'
    },
    {
        src: 'works_jpg/map_works/map_07.jpg',
        alt: 'Map 07'
    },
    {
        src: 'works_jpg/map_works/map_04.jpg',
        alt: 'Map 04'
    },
    {
        src: 'works_jpg/map_works/map_01.jpg',
        alt: 'Map 01'
    },
    {
        src: 'works_jpg/map_works/DaMing Palace.png',
        alt: 'DaMing Palace'
    },
    {
        src: 'works_jpg/map_works/s3.jpg',
        alt: 'S3'
    },
    {
        src: 'works_jpg/map_works/map_02.jpg',
        alt: 'Map 02'
    },
    {
        src: 'works_jpg/map_works/map_03.jpg',
        alt: 'Map 03'
    },
    {
        src: 'works_jpg/map_works/Map_of_Eurasia03.jpg',
        alt: 'Map of Eurasia 03'
    }
];

// Drawing art works data from the local folder
const drawingArtData = [
    {
        src: 'works_jpg/drawing_works/rain-wang-asset (6).jpg',
        alt: 'Drawing Asset 6'
    },
    {
        src: 'works_jpg/drawing_works/rain-wang-asset (7).jpg',
        alt: 'Drawing Asset 7'
    },
    {
        src: 'works_jpg/drawing_works/rain-wang-asset (8).jpg',
        alt: 'Drawing Asset 8'
    },
    {
        src: 'works_jpg/drawing_works/rain-wang-asset (9).jpg',
        alt: 'Drawing Asset 9'
    },
    {
        src: 'works_jpg/drawing_works/rain-wang-asset (10).jpg',
        alt: 'Drawing Asset 10'
    },
    {
        src: 'works_jpg/drawing_works/rain-wang-asset (11).jpg',
        alt: 'Drawing Asset 11'
    },
    {
        src: 'works_jpg/drawing_works/rain-wang-asset (12).jpg',
        alt: 'Drawing Asset 12'
    }
];

// Fine art works data from the local folder
const fineArtData = [
    {
        src: 'works_jpg/fine_art_works/Dual Reality_01.JPG',
        alt: 'Dual Reality 01'
    },
    {
        src: 'works_jpg/fine_art_works/Dual Reality_02.JPG',
        alt: 'Dual Reality 02'
    },
    {
        src: 'works_jpg/fine_art_works/IMG-2180.jpg',
        alt: 'Fine Art Work'
    }
];

// Modal variables
let currentImageIndex = 0;
let currentImageType = 'horizontal'; // 'horizontal', 'vertical', 'dual-reality', or 'illustration'
let modal = null;
let modalImage = null;
let modalTitle = null;
let closeBtn = null;
let prevBtn = null;
let nextBtn = null;

// Function to extract artwork title from filename (remove number suffix)
function extractArtworkTitle(filename) {
    // Remove file extension first
    const nameWithoutExt = filename.replace(/\.(jpg|jpeg|png|gif)$/i, '');
    
    // Remove number suffix pattern like _01, _02, etc.
    const titleWithoutNumber = nameWithoutExt.replace(/_\d+$/, '');
    
    return titleWithoutNumber;
}

// Function to create artwork grid
function createArtworkGrid() {
    const grid = document.getElementById('artworkGrid');
    
    if (!grid) {
        console.error('Artwork grid element not found');
        return;
    }
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create artwork items
    artworkData.forEach((artwork, index) => {
        const artworkItem = document.createElement('div');
        artworkItem.className = 'artwork-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'horizontal');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'artwork-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.warn(`Failed to load image: ${artwork.src}`);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'horizontal');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
    });
}

// Function to create vertical artwork grid
function createVerticalArtworkGrid() {
    const grid = document.getElementById('verticalArtworkGrid');
    
    if (!grid) {
        console.error('Vertical artwork grid element not found');
        return;
    }
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create vertical artwork items
    verticalArtworkData.forEach((artwork, index) => {
        const artworkItem = document.createElement('div');
        artworkItem.className = 'vertical-artwork-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'vertical');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'vertical-artwork-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.warn(`Failed to load vertical image: ${artwork.src}`);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'vertical');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
    });
}

// Function to create dual reality artwork grid
function createDualRealityArtworkGrid() {
    const grid = document.getElementById('dualRealityGrid');
    
    if (!grid) {
        console.error('Dual reality grid element not found');
        return;
    }
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create dual reality artwork items
    dualRealityArtworkData.forEach((artwork, index) => {
        const artworkItem = document.createElement('div');
        artworkItem.className = 'dual-reality-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'dual-reality');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'dual-reality-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.warn(`Failed to load dual reality image: ${artwork.src}`);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'dual-reality');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
    });
}

// Function to create illustration artwork grid
function createIllustrationArtworkGrid() {
    const grid = document.getElementById('illustrationGrid');
    
    if (!grid) {
        console.error('Illustration grid element not found');
        return;
    }
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create illustration artwork items
    illustrationArtworkData.forEach((artwork, index) => {
        const artworkItem = document.createElement('div');
        artworkItem.className = 'illustration-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'illustration');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'illustration-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.error(`Failed to load illustration image: ${artwork.src}`);
            console.error('Image element:', this);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            console.log(`Successfully loaded illustration image: ${artwork.src}`);
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'illustration');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
    });
}

// Function to create illustration practice works grid
function createIllustrationPracticeGrid() {
    console.log('createIllustrationPracticeGrid called');
    const grid = document.getElementById('illustrationPracticeGrid');
    
    if (!grid) {
        console.error('Illustration practice grid element not found');
        return;
    }
    
    console.log('Found illustration practice grid:', grid);
    console.log('Practice works data:', illustrationPracticeData);
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create illustration practice items
    illustrationPracticeData.forEach((artwork, index) => {
        console.log(`Creating practice work ${index + 1}:`, artwork);
        
        const artworkItem = document.createElement('div');
        artworkItem.className = 'illustration-practice-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'illustration-practice');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'illustration-practice-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.error(`Failed to load illustration practice image: ${artwork.src}`);
            console.error('Image element:', this);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            console.log(`Successfully loaded illustration practice image: ${artwork.src}`);
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'illustration-practice');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
        console.log(`Added practice work ${index + 1} to grid`);
    });
    
    console.log('Illustration practice grid created successfully');
}

// Function to create map design grid
function createMapDesignGrid() {
    console.log('createMapDesignGrid called');
    const grid = document.getElementById('mapDesignGrid');
    
    if (!grid) {
        console.error('Map design grid element not found');
        return;
    }
    
    console.log('Found map design grid:', grid);
    console.log('Map design data:', mapDesignData);
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create map design items
    mapDesignData.forEach((artwork, index) => {
        console.log(`Creating map design work ${index + 1}:`, artwork);
        
        const artworkItem = document.createElement('div');
        artworkItem.className = 'map-design-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'map-design');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'map-design-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.error(`Failed to load map design image: ${artwork.src}`);
            console.error('Image element:', this);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            console.log(`Successfully loaded map design image: ${artwork.src}`);
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'map-design');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
        console.log(`Added map design work ${index + 1} to grid`);
    });
    
    console.log('Map design grid created successfully');
}

// Function to create drawing art grid
function createDrawingArtGrid() {
    console.log('createDrawingArtGrid called');
    const grid = document.getElementById('drawingArtGrid');
    
    if (!grid) {
        console.error('Drawing art grid element not found');
        return;
    }
    
    console.log('Found drawing art grid:', grid);
    console.log('Drawing art data:', drawingArtData);
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create drawing art items
    drawingArtData.forEach((artwork, index) => {
        console.log(`Creating drawing art work ${index + 1}:`, artwork);
        
        const artworkItem = document.createElement('div');
        artworkItem.className = 'drawing-art-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'drawing-art');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'drawing-art-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.error(`Failed to load drawing art image: ${artwork.src}`);
            console.error('Image element:', this);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            console.log(`Successfully loaded drawing art image: ${artwork.src}`);
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'drawing-art');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
        console.log(`Added drawing art work ${index + 1} to grid`);
    });
    
    console.log('Drawing art grid created successfully');
}

// Function to create fine art grid
function createFineArtGrid() {
    console.log('createFineArtGrid called');
    const grid = document.getElementById('fineArtGrid');
    
    if (!grid) {
        console.error('Fine art grid element not found');
        return;
    }
    
    console.log('Found fine art grid:', grid);
    console.log('Fine art data:', fineArtData);
    
    // Clear existing content
    grid.innerHTML = '';
    
    // Create fine art items
    fineArtData.forEach((artwork, index) => {
        console.log(`Creating fine art work ${index + 1}:`, artwork);
        
        const artworkItem = document.createElement('div');
        artworkItem.className = 'fine-art-item';
        artworkItem.setAttribute('data-index', index);
        artworkItem.setAttribute('data-type', 'fine-art');
        
        const img = document.createElement('img');
        img.src = artwork.src;
        img.alt = artwork.alt;
        img.className = 'fine-art-image';
        
        // Add loading error handling
        img.onerror = function() {
            console.error(`Failed to load fine art image: ${artwork.src}`);
            console.error('Image element:', this);
            this.style.display = 'none';
        };
        
        // Add loading success handling
        img.onload = function() {
            console.log(`Successfully loaded fine art image: ${artwork.src}`);
            this.style.opacity = '1';
        };
        
        // Add click event for modal
        artworkItem.addEventListener('click', () => {
            openModal(index, 'fine-art');
        });
        
        artworkItem.appendChild(img);
        grid.appendChild(artworkItem);
        console.log(`Added fine art work ${index + 1} to grid`);
    });
    
    console.log('Fine art grid created successfully');
}

// Function to open modal
function openModal(index, type) {
    currentImageIndex = index;
    currentImageType = type;
    
    let artwork;
    if (type === 'horizontal') {
        artwork = artworkData[index];
    } else if (type === 'vertical') {
        artwork = verticalArtworkData[index];
    } else if (type === 'dual-reality') {
        artwork = dualRealityArtworkData[index];
    } else if (type === 'illustration') {
        artwork = illustrationArtworkData[index];
    } else if (type === 'illustration-practice') {
        artwork = illustrationPracticeData[index];
    } else if (type === 'map-design') {
        artwork = mapDesignData[index];
    } else if (type === 'drawing-art') {
        artwork = drawingArtData[index];
    } else if (type === 'fine-art') {
        artwork = fineArtData[index];
    }
    
    if (!modal || !modalImage || !modalTitle) {
        console.error('Modal elements not found');
        return;
    }
    
    // Set image source and alt text
    modalImage.src = artwork.src;
    modalImage.alt = artwork.alt;
    
    // Extract and display artwork title
    const filename = artwork.src.split('/').pop(); // Get filename from path
    const artworkTitle = extractArtworkTitle(filename);
    modalTitle.textContent = artworkTitle;
    
    // Show modal
    modal.classList.add('show');
    document.body.style.overflow = 'hidden'; // Prevent background scrolling
    
    // Update navigation buttons
    updateNavigationButtons();
}

// Function to close modal
function closeModal() {
    if (!modal) return;
    
    modal.classList.remove('show');
    document.body.style.overflow = ''; // Restore scrolling
}

// Function to navigate to previous image
function showPreviousImage() {
    if (currentImageIndex > 0) {
        currentImageIndex--;
        
        let artwork;
        if (currentImageType === 'horizontal') {
            artwork = artworkData[currentImageIndex];
        } else if (currentImageType === 'vertical') {
            artwork = verticalArtworkData[currentImageIndex];
        } else if (currentImageType === 'dual-reality') {
            artwork = dualRealityArtworkData[currentImageIndex];
        } else if (currentImageType === 'illustration') {
            artwork = illustrationArtworkData[currentImageIndex];
        } else if (currentImageType === 'illustration-practice') {
            artwork = illustrationPracticeData[currentImageIndex];
        } else if (currentImageType === 'map-design') {
            artwork = mapDesignData[currentImageIndex];
        } else if (currentImageType === 'drawing-art') {
            artwork = drawingArtData[currentImageIndex];
        } else if (currentImageType === 'fine-art') {
            artwork = fineArtData[currentImageIndex];
        }
        
        modalImage.src = artwork.src;
        modalImage.alt = artwork.alt;
        
        // Update artwork title
        const filename = artwork.src.split('/').pop();
        const artworkTitle = extractArtworkTitle(filename);
        modalTitle.textContent = artworkTitle;
        
        updateNavigationButtons();
    }
}

// Function to navigate to next image
function showNextImage() {
    let maxIndex;
    if (currentImageType === 'horizontal') {
        maxIndex = artworkData.length - 1;
    } else if (currentImageType === 'vertical') {
        maxIndex = verticalArtworkData.length - 1;
    } else if (currentImageType === 'dual-reality') {
        maxIndex = dualRealityArtworkData.length - 1;
    } else if (currentImageType === 'illustration') {
        maxIndex = illustrationArtworkData.length - 1;
    } else if (currentImageType === 'illustration-practice') {
        maxIndex = illustrationPracticeData.length - 1;
    } else if (currentImageType === 'map-design') {
        maxIndex = mapDesignData.length - 1;
    } else if (currentImageType === 'drawing-art') {
        maxIndex = drawingArtData.length - 1;
    } else if (currentImageType === 'fine-art') {
        maxIndex = fineArtData.length - 1;
    }
    
    if (currentImageIndex < maxIndex) {
        currentImageIndex++;
        
        let artwork;
        if (currentImageType === 'horizontal') {
            artwork = artworkData[currentImageIndex];
        } else if (currentImageType === 'vertical') {
            artwork = verticalArtworkData[currentImageIndex];
        } else if (currentImageType === 'dual-reality') {
            artwork = dualRealityArtworkData[currentImageIndex];
        } else if (currentImageType === 'illustration') {
            artwork = illustrationArtworkData[currentImageIndex];
        } else if (currentImageType === 'illustration-practice') {
            artwork = illustrationPracticeData[currentImageIndex];
        } else if (currentImageType === 'map-design') {
            artwork = mapDesignData[currentImageIndex];
        } else if (currentImageType === 'drawing-art') {
            artwork = drawingArtData[currentImageIndex];
        } else if (currentImageType === 'fine-art') {
            artwork = fineArtData[currentImageIndex];
        }
        
        modalImage.src = artwork.src;
        modalImage.alt = artwork.alt;
        
        // Update artwork title
        const filename = artwork.src.split('/').pop();
        const artworkTitle = extractArtworkTitle(filename);
        modalTitle.textContent = artworkTitle;
        
        updateNavigationButtons();
    }
}

// Function to update navigation buttons state
function updateNavigationButtons() {
    if (!prevBtn || !nextBtn) return;
    
    let maxIndex;
    if (currentImageType === 'horizontal') {
        maxIndex = artworkData.length - 1;
    } else if (currentImageType === 'vertical') {
        maxIndex = verticalArtworkData.length - 1;
    } else if (currentImageType === 'dual-reality') {
        maxIndex = dualRealityArtworkData.length - 1;
    } else if (currentImageType === 'illustration') {
        maxIndex = illustrationArtworkData.length - 1;
    } else if (currentImageType === 'illustration-practice') {
        maxIndex = illustrationPracticeData.length - 1;
    } else if (currentImageType === 'map-design') {
        maxIndex = mapDesignData.length - 1;
    } else if (currentImageType === 'drawing-art') {
        maxIndex = drawingArtData.length - 1;
    } else if (currentImageType === 'fine-art') {
        maxIndex = fineArtData.length - 1;
    }
    
    prevBtn.disabled = currentImageIndex === 0;
    nextBtn.disabled = currentImageIndex === maxIndex;
}

// Function to initialize modal
function initModal() {
    modal = document.getElementById('artworkModal');
    modalImage = document.getElementById('modalImage');
    modalTitle = document.getElementById('modalTitle');
    closeBtn = document.getElementById('closeModal');
    prevBtn = document.getElementById('prevBtn');
    nextBtn = document.getElementById('nextBtn');
    
    if (!modal || !modalImage || !modalTitle || !closeBtn || !prevBtn || !nextBtn) {
        console.error('Modal elements not found');
        return;
    }
    
    // Add event listeners
    closeBtn.addEventListener('click', closeModal);
    prevBtn.addEventListener('click', showPreviousImage);
    nextBtn.addEventListener('click', showNextImage);
    
    // Close modal when clicking on background
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeModal();
        }
    });
    
    // Close modal with ESC key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('show')) {
            closeModal();
        }
        
        // Navigate with arrow keys
        if (modal.classList.contains('show')) {
            if (e.key === 'ArrowLeft') {
                showPreviousImage();
            } else if (e.key === 'ArrowRight') {
                showNextImage();
            }
        }
    });
}

// Function to handle responsive grid adjustments
function adjustGridLayout() {
    const grid = document.getElementById('artworkGrid');
    const verticalGrid = document.getElementById('verticalArtworkGrid');
    const dualRealityGrid = document.getElementById('dualRealityGrid');
    const illustrationGrid = document.getElementById('illustrationGrid');
    const windowWidth = window.innerWidth;
    
    if (!grid || !verticalGrid || !dualRealityGrid) return;
    
    // Adjust grid columns based on screen size
    if (windowWidth > 1200) {
        grid.style.gridTemplateColumns = 'repeat(3, 1fr)';
        grid.style.gridAutoRows = '300px';
        grid.style.maxWidth = '1600px';
        grid.style.padding = '0 10px';
        grid.style.gap = '5px';
        
        verticalGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
        verticalGrid.style.gridTemplateRows = ''; // 清空强制高度，让图片保持原始比例
        verticalGrid.style.maxWidth = '1600px';
        verticalGrid.style.padding = '0 10px';
        verticalGrid.style.gap = '2px';
        
        dualRealityGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
        dualRealityGrid.style.gridAutoRows = '300px';
        dualRealityGrid.style.maxWidth = '1600px';
        dualRealityGrid.style.padding = '0 10px';
        dualRealityGrid.style.gap = '5px';
        
        if (illustrationGrid) {
            illustrationGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
            illustrationGrid.style.gridAutoRows = '300px';
            illustrationGrid.style.maxWidth = '1600px';
            illustrationGrid.style.padding = '0 10px';
            illustrationGrid.style.gap = '5px';
        }
    } else if (windowWidth > 768) {
        grid.style.gridTemplateColumns = 'repeat(3, 1fr)';
        grid.style.gridAutoRows = '280px';
        grid.style.maxWidth = '1200px';
        grid.style.padding = '0 8px';
        grid.style.gap = '4px';
        
        verticalGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
        verticalGrid.style.gridTemplateRows = ''; // 清空强制高度，让图片保持原始比例
        verticalGrid.style.maxWidth = '1200px';
        verticalGrid.style.padding = '0 8px';
        verticalGrid.style.gap = '2px';
        
        dualRealityGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
        dualRealityGrid.style.gridAutoRows = '280px';
        dualRealityGrid.style.maxWidth = '1200px';
        dualRealityGrid.style.padding = '0 8px';
        dualRealityGrid.style.gap = '4px';
        
        if (illustrationGrid) {
            illustrationGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
            illustrationGrid.style.gridAutoRows = '280px';
            illustrationGrid.style.maxWidth = '1200px';
            illustrationGrid.style.padding = '0 8px';
            illustrationGrid.style.gap = '4px';
        }
    } else if (windowWidth > 480) {
        grid.style.gridTemplateColumns = 'repeat(2, 1fr)';
        grid.style.gridAutoRows = '250px';
        grid.style.padding = '0 8px';
        grid.style.gap = '3px';
        
        verticalGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
        verticalGrid.style.gridTemplateRows = ''; // 清空强制高度，让图片保持原始比例
        verticalGrid.style.padding = '0 8px';
        verticalGrid.style.gap = '2px';
        
        dualRealityGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
        dualRealityGrid.style.gridAutoRows = '250px';
        dualRealityGrid.style.padding = '0 8px';
        dualRealityGrid.style.gap = '3px';
        
        if (illustrationGrid) {
            illustrationGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
            illustrationGrid.style.gridAutoRows = '250px';
            illustrationGrid.style.padding = '0 8px';
            illustrationGrid.style.gap = '3px';
        }
    } else {
        grid.style.gridTemplateColumns = '1fr';
        grid.style.gridAutoRows = '200px';
        grid.style.padding = '0 6px';
        grid.style.gap = '3px';
        
        verticalGrid.style.gridTemplateColumns = '1fr'; /* 1 column on mobile */
        verticalGrid.style.gridTemplateRows = ''; // 清空强制高度，让图片保持原始比例
        verticalGrid.style.padding = '0 6px';
        verticalGrid.style.gap = '2px';
        
        dualRealityGrid.style.gridTemplateColumns = '1fr';
        dualRealityGrid.style.gridAutoRows = '200px';
        dualRealityGrid.style.padding = '0 6px';
        dualRealityGrid.style.gap = '3px';
        
        if (illustrationGrid) {
            illustrationGrid.style.gridTemplateColumns = '1fr';
            illustrationGrid.style.gridAutoRows = '200px';
            illustrationGrid.style.padding = '0 6px';
            illustrationGrid.style.gap = '3px';
        }
    }
}

// Function to handle smooth scrolling for navigation
function initNavigation() {
    const navLinks = document.querySelectorAll('.nav-link');
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            // Only prevent default for main navigation links (not dropdown links)
            if (this.getAttribute('href').startsWith('#')) {
                e.preventDefault();
                
                // Remove active class from all links
                navLinks.forEach(l => l.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
                
                // For now, just prevent default behavior
                // Future implementation will handle page navigation
            }
            // Allow external links (like dropdown menu links) to work normally
        });
    });
}

// Function to handle header scroll effect (removed old implementation)
function initHeaderScroll() {
    // This function is now handled by the new scroll handling system
    // The header visibility is controlled by the handleScroll function below
}

// Function to optimize image loading
function optimizeImageLoading() {
    const images = document.querySelectorAll('.artwork-image, .vertical-artwork-image, .dual-reality-image, .illustration-image, .illustration-practice-image, .map-design-image, .drawing-art-image, .fine-art-image');
    
    console.log(`Found ${images.length} images to optimize`);
    
    images.forEach((img, index) => {
        console.log(`Image ${index + 1}:`, img.src);
        
        // Set initial opacity to 0 for smooth loading
        img.style.opacity = '0';
        img.style.transition = 'opacity 0.5s ease';
        
        // Load image with error handling
        if (img.complete) {
            console.log(`Image ${index + 1} already complete:`, img.src);
            img.style.opacity = '1';
        } else {
            img.addEventListener('load', function() {
                console.log(`Image loaded successfully:`, this.src);
                this.style.opacity = '1';
            });
            
            img.addEventListener('error', function() {
                console.error(`Failed to load image: ${this.src}`);
                console.error('Image element:', this);
                this.style.display = 'none';
            });
        }
    });
}

// Initialize everything when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    
    // Initialize modal first
    initModal();
    
    // Create artwork grid
    createArtworkGrid();

    // Create vertical artwork grid
    createVerticalArtworkGrid();
    
    // Create dual reality artwork grid
    createDualRealityArtworkGrid();
    
    // Create illustration artwork grid
    createIllustrationArtworkGrid();
    
    // Create illustration practice works grid
    createIllustrationPracticeGrid();
    
    // Create map design grid
    createMapDesignGrid();
    
    // Create drawing art grid
    createDrawingArtGrid();
    
    // Create fine art grid
    createFineArtGrid();
    
    // Initialize navigation
    initNavigation();
    
    // Initialize page navigation
    initPageNavigation();
    
    // Initialize artist name link
    initArtistNameLink();
    
    // Initialize header scroll effect
    initHeaderScroll();
    
    // Optimize image loading
    setTimeout(optimizeImageLoading, 100);
    
    // Adjust grid layout
    adjustGridLayout();
    
    // Handle window resize
    window.addEventListener('resize', adjustGridLayout);
    
    // Handle scroll for header visibility
    window.addEventListener('scroll', handleScroll);
});

// Page Navigation Functions
function showArtworkPage() {
    const artworkPage = document.querySelector('.main-content');
    const aboutPage = document.getElementById('aboutPage');
    const personalReelPage = document.getElementById('personalReelPage');
    const illustrationPage = document.getElementById('illustrationPage');
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    if (artworkPage && aboutPage && personalReelPage && illustrationPage) {
        artworkPage.style.display = 'block';
        aboutPage.style.display = 'none';
        personalReelPage.style.display = 'none';
        illustrationPage.style.display = 'none';
    }
    
    if (artworkLink && aboutLink) {
        artworkLink.classList.add('active');
        aboutLink.classList.remove('active');
    }
}

function showAboutPage() {
    console.log('showAboutPage called'); // Debug log
    const artworkPage = document.querySelector('.main-content');
    const aboutPage = document.getElementById('aboutPage');
    const personalReelPage = document.getElementById('personalReelPage');
    const illustrationPage = document.getElementById('illustrationPage');
    const mapDesignPage = document.getElementById('mapDesignPage');
    const drawingArtPage = document.getElementById('drawingArtPage');
    const fineArtPage = document.getElementById('fineArtPage');
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    console.log('Pages found:', { artworkPage, aboutPage, personalReelPage, illustrationPage, mapDesignPage, drawingArtPage, fineArtPage }); // Debug log
    
    if (artworkPage && aboutPage && personalReelPage && illustrationPage && mapDesignPage && drawingArtPage && fineArtPage) {
        artworkPage.style.display = 'none';
        aboutPage.style.display = 'block';
        personalReelPage.style.display = 'none';
        illustrationPage.style.display = 'none';
        mapDesignPage.style.display = 'none';
        drawingArtPage.style.display = 'none';
        fineArtPage.style.display = 'none';
        console.log('About page displayed successfully'); // Debug log
    }
    
    if (artworkLink && aboutLink) {
        artworkLink.classList.remove('active');
        aboutLink.classList.add('active');
    }
}

function showPersonalReelPage() {
    console.log('showPersonalReelPage called'); // Debug log
    const artworkPage = document.querySelector('.main-content');
    const aboutPage = document.getElementById('aboutPage');
    const personalReelPage = document.getElementById('personalReelPage');
    const illustrationPage = document.getElementById('illustrationPage');
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    console.log('Pages found:', { artworkPage, aboutPage, personalReelPage, illustrationPage }); // Debug log
    
    if (artworkPage && aboutPage && personalReelPage && illustrationPage) {
        artworkPage.style.display = 'none';
        aboutPage.style.display = 'none';
        personalReelPage.style.display = 'block';
        illustrationPage.style.display = 'none';
        console.log('Pages switched successfully'); // Debug log
    }
    
    if (artworkLink && aboutLink) {
        artworkLink.classList.remove('active');
        aboutLink.classList.remove('active');
    }
}

function showIllustrationPage() {
    console.log('showIllustrationPage called'); // Debug log
    const artworkPage = document.querySelector('.main-content');
    const aboutPage = document.getElementById('aboutPage');
    const personalReelPage = document.getElementById('personalReelPage');
    const illustrationPage = document.getElementById('illustrationPage');
    const mapDesignPage = document.getElementById('mapDesignPage');
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    console.log('Pages found:', { artworkPage, aboutPage, personalReelPage, illustrationPage, mapDesignPage }); // Debug log
    
    if (artworkPage && aboutPage && personalReelPage && illustrationPage && mapDesignPage) {
        artworkPage.style.display = 'none';
        aboutPage.style.display = 'none';
        personalReelPage.style.display = 'none';
        illustrationPage.style.display = 'block';
        mapDesignPage.style.display = 'none';
        console.log('Illustration page displayed successfully'); // Debug log
        
        // Recreate illustration grids when page is shown
        setTimeout(() => {
            createIllustrationArtworkGrid();
            createIllustrationPracticeGrid();
            setTimeout(optimizeImageLoading, 100);
        }, 100);
    }
    
    if (artworkLink && aboutLink) {
        artworkLink.classList.remove('active');
        aboutLink.classList.remove('active');
    }
}

function showMapDesignPage() {
    console.log('showMapDesignPage called'); // Debug log
    const artworkPage = document.querySelector('.main-content');
    const aboutPage = document.getElementById('aboutPage');
    const personalReelPage = document.getElementById('personalReelPage');
    const illustrationPage = document.getElementById('illustrationPage');
    const mapDesignPage = document.getElementById('mapDesignPage');
    const drawingArtPage = document.getElementById('drawingArtPage');
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    console.log('Pages found:', { artworkPage, aboutPage, personalReelPage, illustrationPage, mapDesignPage, drawingArtPage }); // Debug log
    
    if (artworkPage && aboutPage && personalReelPage && illustrationPage && mapDesignPage && drawingArtPage) {
        artworkPage.style.display = 'none';
        aboutPage.style.display = 'none';
        personalReelPage.style.display = 'none';
        illustrationPage.style.display = 'none';
        mapDesignPage.style.display = 'block';
        drawingArtPage.style.display = 'none';
        console.log('Map Design page displayed successfully'); // Debug log
        
        // Recreate map design grid when page is shown
        setTimeout(() => {
            createMapDesignGrid();
            setTimeout(optimizeImageLoading, 100);
        }, 100);
    }
    
    if (artworkLink && aboutLink) {
        artworkLink.classList.remove('active');
        aboutLink.classList.remove('active');
    }
}

function showDrawingArtPage() {
    console.log('showDrawingArtPage called'); // Debug log
    const artworkPage = document.querySelector('.main-content');
    const aboutPage = document.getElementById('aboutPage');
    const personalReelPage = document.getElementById('personalReelPage');
    const illustrationPage = document.getElementById('illustrationPage');
    const mapDesignPage = document.getElementById('mapDesignPage');
    const drawingArtPage = document.getElementById('drawingArtPage');
    const fineArtPage = document.getElementById('fineArtPage');
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    console.log('Pages found:', { artworkPage, aboutPage, personalReelPage, illustrationPage, mapDesignPage, drawingArtPage, fineArtPage }); // Debug log
    
    if (artworkPage && aboutPage && personalReelPage && illustrationPage && mapDesignPage && drawingArtPage && fineArtPage) {
        artworkPage.style.display = 'none';
        aboutPage.style.display = 'none';
        personalReelPage.style.display = 'none';
        illustrationPage.style.display = 'none';
        mapDesignPage.style.display = 'none';
        drawingArtPage.style.display = 'block';
        fineArtPage.style.display = 'none';
        console.log('Drawing Art page displayed successfully'); // Debug log
        
        // Recreate drawing art grid when page is shown
        setTimeout(() => {
            createDrawingArtGrid();
            setTimeout(optimizeImageLoading, 100);
        }, 100);
    }
    
    if (artworkLink && aboutLink) {
        artworkLink.classList.remove('active');
        aboutLink.classList.remove('active');
    }
}

function showFineArtPage() {
    console.log('showFineArtPage called'); // Debug log
    const artworkPage = document.querySelector('.main-content');
    const aboutPage = document.getElementById('aboutPage');
    const personalReelPage = document.getElementById('personalReelPage');
    const illustrationPage = document.getElementById('illustrationPage');
    const mapDesignPage = document.getElementById('mapDesignPage');
    const drawingArtPage = document.getElementById('drawingArtPage');
    const fineArtPage = document.getElementById('fineArtPage');
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    console.log('Pages found:', { artworkPage, aboutPage, personalReelPage, illustrationPage, mapDesignPage, drawingArtPage, fineArtPage }); // Debug log
    
    if (artworkPage && aboutPage && personalReelPage && illustrationPage && mapDesignPage && drawingArtPage && fineArtPage) {
        artworkPage.style.display = 'none';
        aboutPage.style.display = 'none';
        personalReelPage.style.display = 'none';
        illustrationPage.style.display = 'none';
        mapDesignPage.style.display = 'none';
        drawingArtPage.style.display = 'none';
        fineArtPage.style.display = 'block';
        console.log('Fine Art page displayed successfully'); // Debug log
        
        // Recreate fine art grid when page is shown
        setTimeout(() => {
            createFineArtGrid();
            setTimeout(optimizeImageLoading, 100);
        }, 100);
    }
    
    if (artworkLink && aboutLink) {
        artworkLink.classList.remove('active');
        aboutLink.classList.remove('active');
    }
}

// Initialize page navigation
function initPageNavigation() {
    const artworkLink = document.querySelector('.nav-link[href="#artwork"]');
    const aboutLink = document.querySelector('.nav-link[href="#about"]');
    
    if (artworkLink) {
        artworkLink.addEventListener('click', function(e) {
            e.preventDefault();
            showArtworkPage();
        });
    }
    
    if (aboutLink) {
        aboutLink.addEventListener('click', function(e) {
            e.preventDefault();
            showAboutPage();
        });
    }
}

// Initialize artist name link
function initArtistNameLink() {
    const artistNameLink = document.querySelector('.artist-name-link');
    
    console.log('Artist name link found:', artistNameLink); // Debug log
    
    if (artistNameLink) {
        artistNameLink.addEventListener('click', function(e) {
            console.log('Artist name link clicked!'); // Debug log
            e.preventDefault();
            // Show the main artwork page (home page)
            showArtworkPage();
        });
        
        // Also add a simple test to see if the element is clickable
        artistNameLink.style.cursor = 'pointer';
        console.log('Event listener added to artist name link'); // Debug log
    } else {
        console.error('Artist name link not found!'); // Debug log
    }
}

// Handle dropdown menu links using event delegation
document.addEventListener('click', function(e) {
    console.log('Click event detected on:', e.target); // Debug log
    console.log('Target classes:', e.target.classList); // Debug log
    console.log('Target href:', e.target.getAttribute('href')); // Debug log
    
    if (e.target.classList.contains('dropdown-link')) {
        console.log('Dropdown link detected!'); // Debug log
        const href = e.target.getAttribute('href');
        console.log('Href value:', href); // Debug log
        
        if (href === '#personal-reel') {
            console.log('Personal Reel clicked via event delegation!'); // Debug log
            e.preventDefault();
            showPersonalReelPage();
        } else if (href === '#artwork') {
            console.log('Concept Art clicked via event delegation!'); // Debug log
            e.preventDefault();
            showArtworkPage();
        } else if (href === '#illustration') {
            console.log('Illustration clicked via event delegation!'); // Debug log
            e.preventDefault();
            showIllustrationPage();
        } else if (href === 'map-design.html') {
            console.log('Map Design clicked via event delegation!'); // Debug log
            e.preventDefault();
            showMapDesignPage();
        } else if (href === 'drawing-art.html') {
            console.log('Drawing Art clicked via event delegation!'); // Debug log
            e.preventDefault();
            showDrawingArtPage();
        } else if (href === 'fine-art.html') {
            console.log('Fine Art clicked via event delegation!'); // Debug log
            e.preventDefault();
            showFineArtPage();
        } else {
            console.log('Unknown href:', href); // Debug log
        }
    } else {
        console.log('Not a dropdown link'); // Debug log
    }
});



// Add loading state
window.addEventListener('load', function() {
    document.body.classList.add('loaded');
}); 

// Scroll handling for header visibility
let lastScrollTop = 0;
const header = document.querySelector('header');
const scrollThreshold = 50; // Minimum scroll distance before hiding/showing

function handleScroll() {
    const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    // Only trigger if scroll distance is significant
    if (Math.abs(currentScrollTop - lastScrollTop) > scrollThreshold) {
        if (currentScrollTop > lastScrollTop && currentScrollTop > 100) {
            // Scrolling down and not at the top
            header.classList.add('hidden');
        } else {
            // Scrolling up or at the top
            header.classList.remove('hidden');
        }
        lastScrollTop = currentScrollTop;
    }
}

// Add scroll event listener
window.addEventListener('scroll', handleScroll, { passive: true }); 